<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Data Analysis • eikosograms</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Data Analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">eikosograms</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/Introduction.html">Intro</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/IndependenceExploration.html">Exploring Independence</a></li>
    <li><a class="dropdown-item" href="../articles/DataAnalysis.html">Data Analysis Examples</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-resources" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Resources</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-resources">
<li><a class="external-link dropdown-item" href="https://www.math.uwaterloo.ca/~rwoldfor/talks/SSC2009/talk/">Talk Slides (SSC 2009)</a></li>
    <li><a class="external-link dropdown-item" href="https://math.uwaterloo.ca/~rwoldfor/papers/eikosograms/paperpdf.pdf">Picturing Probability (extended manuscript)</a></li>
    <li><a class="external-link dropdown-item" href="https://math.uwaterloo.ca/~rwoldfor/papers/eikosograms/independence/paper.pdf">Understanding Independence</a></li>
    <li><a class="external-link dropdown-item" href="https://math.uwaterloo.ca/~rwoldfor/papers/eikosograms/examples/paper.pdf">Problems and Paradoxes</a></li>
    <li><a class="external-link dropdown-item" href="https://math.uwaterloo.ca/~rwoldfor/papers/eikosograms/paper-ssnew.pdf">Poverty of Venn (original)</a></li>
    <li><a class="external-link dropdown-item" href="https://math.uwaterloo.ca/~rwoldfor/papers/eikosograms/paper.pdf">Poverty of Venn (revised with formal axioms)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rwoldford/eikosograms" aria-label="GitHub repository for eikosograms"><span class="fa fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Data Analysis</h1>
                        <h4 data-toc-skip class="author">R. W.
Oldford</h4>
            
            <h4 data-toc-skip class="date">August 21, 2018</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rwoldford/eikosograms/blob/HEAD/vignettes/DataAnalysis.Rmd" class="external-link"><code>vignettes/DataAnalysis.Rmd</code></a></small>
      <div class="d-none name"><code>DataAnalysis.Rmd</code></div>
    </div>

    
    
<hr>
<p>The other vignettes emphasize the use of eikosograms in understanding
probability and relations between categorical variates. Here, we just
give a few example of the use of eikosograms in data analysis.</p>
<p>Because categorical data can present itself in a variety of forms
(e.g. <code>tables</code>, <code>factors</code> in a data frame, etc.),
the illustrations centre around different types of data structure</p>
<div class="section level2">
<h2 id="tables">tables<a class="anchor" aria-label="anchor" href="#tables"></a>
</h2>
<p>Contingency tables (multi-way tables or “data cubes”) are possibly
the most common arrangement of categorical data. They are used, for
example, in the introductory vignette.</p>
<p>Here, we present a simple analysis of the University of California
(Berkeley) graduate school admissions.</p>
<p>Note that eikosograms are <code>grid</code> objects
(<code><a href="../reference/eikos.html">eikos()</a></code> returns a <code>grob</code>) and so may be
manipulated as any other. For example, several eikosograms could appear
in the same display using <code><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange()</a></code> (from the
<code>gridExtra</code> package).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rwoldford/eikosograms" class="external-link">eikosograms</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span></code></pre></div>
<p>University administrators were apparently alarmed (as they often are)
when they looked at the numbers and saw the relationship between gender
and admission rates.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">e1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eikos.html">eikos</a></span><span class="op">(</span><span class="va">Admit</span> <span class="op">~</span> <span class="va">Gender</span>, data <span class="op">=</span> <span class="va">UCBAdmissions</span>, </span>
<span>            yaxs <span class="op">=</span> <span class="cn">FALSE</span>, xaxs <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>            draw <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">e2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eikos.html">eikos</a></span><span class="op">(</span><span class="va">Admit</span> <span class="op">~</span> <span class="va">Dept</span>, data <span class="op">=</span> <span class="va">UCBAdmissions</span>,  </span>
<span>            yaxs <span class="op">=</span> <span class="cn">FALSE</span>, xaxs <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>            draw <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># Using the gridExtra package, draw these in a single plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">e1</span>, <span class="va">e2</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="img/DataAnalysis/UCB2way.png" class="r-plt" alt="" width="80%" style="display: block; margin: auto;"></p>
<p>At left we see that male applicants are admitted more frequently than
female applicants, suggesting a possible gender bias to university
administrators. At right, we see that some departments admit more
applicants than others, suggesting some may be more difficult to get
into than others.</p>
<p>When all three variates are considered together, the true story
emerges</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eikos.html">eikos</a></span><span class="op">(</span><span class="va">Admit</span> <span class="op">~</span>  <span class="va">Gender</span> <span class="op">+</span> <span class="va">Dept</span>, data <span class="op">=</span> <span class="va">UCBAdmissions</span>,  </span>
<span>      yaxs <span class="op">=</span> <span class="cn">FALSE</span>, xaxs <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>      lock_aspect <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>      xlab_rot <span class="op">=</span> <span class="fl">90</span>, xvals_size <span class="op">=</span> <span class="fl">8</span>,</span>
<span>      ispace <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>bottom <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="img/DataAnalysis/UCB3way.png" class="r-plt" alt="" width="80%" style="display: block; margin: auto;">
In all departments but C and E (which are near equal), a greater
proportion of female applicants were accepted than males. This is a
famous example of Simpson’s paradox. As can be seen perhaps more clearly
from the following eikosogram, the reason for the apparent favouritism
towards male applicants occured only because a great many more males
than females applied to those departments with the highest admission
rates. And in those departments (A and B) the admission rates for
females was much higher than that for males!</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eikos.html">eikos</a></span><span class="op">(</span><span class="va">Gender</span> <span class="op">~</span> <span class="va">Dept</span>, data <span class="op">=</span> <span class="va">UCBAdmissions</span>, yprobs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.25</span><span class="op">)</span>, xaxs <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="img/DataAnalysis/UCBAdmissions.png" class="r-plt" alt="" width="50%" style="display: block; margin: auto;">
Female applicants outnumber male applicants only in departments C and
E.</p>
</div>
<div class="section level2">
<h2 id="cross-tabulation">cross tabulation<a class="anchor" aria-label="anchor" href="#cross-tabulation"></a>
</h2>
<p>Sometimes the counts appear as a column in a spreadsheet (or
<code>data.frame</code>). Here we consider the counts for habitat type
of adult male <strong>anolis</strong> lizards from Bimini. These are
taken from <span class="citation">Schoener (1968)</span> and are saved
here as a text file.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lizards</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="st">"data/AnolisLizards.txt"</span>, header<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">lizards</span></span></code></pre></div>
<pre><code><span><span class="co">##       species perch_height_ft perch_diameter_inches count</span></span>
<span><span class="co">## 1      sagrei            &gt;= 3               &lt;= 4.25    15</span></span>
<span><span class="co">## 2      sagrei            &gt;= 3                &gt; 4.25    18</span></span>
<span><span class="co">## 3      sagrei             &lt; 3               &lt;= 4.25    48</span></span>
<span><span class="co">## 4      sagrei             &lt; 3                &gt; 4.25    84</span></span>
<span><span class="co">## 5 augusticeps            &gt;= 3               &lt;= 4.25    21</span></span>
<span><span class="co">## 6 augusticeps            &gt;= 3                &gt; 4.25     1</span></span>
<span><span class="co">## 7 augusticeps             &lt; 3               &lt;= 4.25     3</span></span>
<span><span class="co">## 8 augusticeps             &lt; 3                &gt; 4.25     2</span></span></code></pre>
<p>As can be seen, there are three categorical variates, the
<code>species</code> of the <em>anolis</em> lizard, the height (in feet)
of where it was observed, and the diameter (in inches) of the branch on
which it was perched. The number of such observations is given as the
fourth variable, <code>count</code>.</p>
<p>For example, this can be a very convenient form of the data for
selecting subsets, particularly for large data sets. Here we might
separate the two species:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sagrei</span> <span class="op">&lt;-</span> <span class="va">lizards</span><span class="op">[</span><span class="va">lizards</span><span class="op">$</span><span class="va">species</span> <span class="op">==</span> <span class="st">"sagrei"</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">augusticeps</span> <span class="op">&lt;-</span> <span class="va">lizards</span><span class="op">[</span><span class="va">lizards</span><span class="op">$</span><span class="va">species</span> <span class="op">==</span> <span class="st">"augusticeps"</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span></span></code></pre></div>
<p>Following <span class="citation">Fienberg (1980)</span>, we might
first consider the relation between perch height and perch diameter for
the <code>sagrei</code> species. To look at the eikosigram, these need
to be turned into a table using the cross-tabulation
<code><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs()</a></code> function:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sagreiTable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="va">count</span> <span class="op">~</span> <span class="va">perch_height_ft</span> <span class="op">+</span> <span class="va">perch_diameter_inches</span>, data <span class="op">=</span> <span class="va">sagrei</span><span class="op">)</span></span></code></pre></div>
<p>and draw it</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eikos.html">eikos</a></span><span class="op">(</span><span class="va">perch_height_ft</span> <span class="op">~</span> <span class="va">perch_diameter_inches</span>, data <span class="op">=</span> <span class="va">sagreiTable</span>, </span>
<span>      main <span class="op">=</span> <span class="st">"Habitat of adult male anolis sagrei lizards"</span><span class="op">)</span></span></code></pre></div>
<p><img src="img/DataAnalysis/sagreiPerch.png" class="r-plt" alt="" width="50%" style="display: block; margin: auto;"></p>
<p>The two heights of the bars are very nearly the same, suggesting that
the height and the diameter of the perch might be independent variates
for the <em>anolis sagrei</em> lizard of Bimini. Indeed, a formal test
of independence gives no evidence against this hypothesis.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html" class="external-link">chisq.test</a></span><span class="op">(</span><span class="va">sagreiTable</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Pearson's Chi-squared test with Yates' continuity correction</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  sagreiTable</span></span>
<span><span class="co">## X-squared = 0.57934, df = 1, p-value = 0.4466</span></span></code></pre>
<p>Now, were we to consider the same for <em>anolis augusticeps</em>,
first the table</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">augusticepsTable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="va">count</span> <span class="op">~</span> <span class="va">perch_height_ft</span> <span class="op">+</span> <span class="va">perch_diameter_inches</span>, data <span class="op">=</span> <span class="va">augusticeps</span><span class="op">)</span></span></code></pre></div>
<p>and then its probability picture</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eikos.html">eikos</a></span><span class="op">(</span><span class="va">perch_height_ft</span> <span class="op">~</span> <span class="va">perch_diameter_inches</span>, data <span class="op">=</span> <span class="va">augusticepsTable</span>, </span>
<span>      main <span class="op">=</span> <span class="st">"Habitat of adult male anolis augusticeps lizards"</span><span class="op">)</span></span></code></pre></div>
<p><img src="img/DataAnalysis/augusticepsPerch.png" class="r-plt" alt="" width="50%" style="display: block; margin: auto;"></p>
<p>Clearly, the bars do not appear to be of equal height. That the
eikosogram is not even nearly flat is <strong>suggestive</strong> that
perch height and diameter are not independent for the species <em>anolis
augusticeps</em>. However, there needs to be some
<strong>caution</strong> exercised here. As with <em>anolis sagrei</em>,
one needs to formally test the hypothesis of independence for a sample
of counts. There are so few observations (1,2, and 3 in three cells and
21 in the largest) that any formal test will also show <strong>no
evidence against the hypothesis of independence</strong> in this case.
(This includes a line up test using eikosograms as the display for each
generated data set!)</p>
<p>All three variates could be examined at once by producing the three
way cross-classified table and the corresponding eikosograms. Following
<span class="citation">Fienberg (1980)</span>, we first consider the
relation between perch height and perch diameter for the
<code>sagrei</code> species of the anolis lizard. The table</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lizardsTable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="va">count</span> <span class="op">~</span> <span class="va">species</span> <span class="op">+</span> <span class="va">perch_height_ft</span> <span class="op">+</span> <span class="va">perch_diameter_inches</span>,</span>
<span>                      data <span class="op">=</span> <span class="va">lizards</span><span class="op">)</span></span></code></pre></div>
<p>and its picture</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eikos.html">eikos</a></span><span class="op">(</span><span class="va">species</span> <span class="op">~</span> <span class="va">.</span> , data <span class="op">=</span> <span class="va">lizardsTable</span>, lock_aspect <span class="op">=</span> <span class="cn">FALSE</span>, yprobs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="img/DataAnalysis/lizards3way.png" class="r-plt" alt="" width="50%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="listings-data-frame-rows">listings (data frame rows)<a class="anchor" aria-label="anchor" href="#listings-data-frame-rows"></a>
</h2>
<p>The final way in which categorical data is commonly presented is in a
listing (e.g. <code>data.frame</code>) where each row corresponds to a
single occurrence of that combination of values for the variates.</p>
<p>For example, consider the <code>mtcars</code> dataset in
<code>R</code>, the first few rows of which are</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="26%">
<col width="7%">
<col width="5%">
<col width="7%">
<col width="5%">
<col width="7%">
<col width="8%">
<col width="8%">
<col width="4%">
<col width="4%">
<col width="7%">
<col width="7%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">mpg</th>
<th align="right">cyl</th>
<th align="right">disp</th>
<th align="right">hp</th>
<th align="right">drat</th>
<th align="right">wt</th>
<th align="right">qsec</th>
<th align="right">vs</th>
<th align="right">am</th>
<th align="right">gear</th>
<th align="right">carb</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Mazda RX4</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.620</td>
<td align="right">16.46</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">Mazda RX4 Wag</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.875</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">Datsun 710</td>
<td align="right">22.8</td>
<td align="right">4</td>
<td align="right">108</td>
<td align="right">93</td>
<td align="right">3.85</td>
<td align="right">2.320</td>
<td align="right">18.61</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Hornet 4 Drive</td>
<td align="right">21.4</td>
<td align="right">6</td>
<td align="right">258</td>
<td align="right">110</td>
<td align="right">3.08</td>
<td align="right">3.215</td>
<td align="right">19.44</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Hornet Sportabout</td>
<td align="right">18.7</td>
<td align="right">8</td>
<td align="right">360</td>
<td align="right">175</td>
<td align="right">3.15</td>
<td align="right">3.440</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Valiant</td>
<td align="right">18.1</td>
<td align="right">6</td>
<td align="right">225</td>
<td align="right">105</td>
<td align="right">2.76</td>
<td align="right">3.460</td>
<td align="right">20.22</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>Although all of these variables are numeric, it is clear that many of
them could be treated as categorical. For example, <code>vs</code> is a
simple indicator variable indicating the shape of the engine block –
<code>0</code> if it the cylinders are arranged in a “V” pattern and 1
if they are aligned in a straight line. This variable might instead have
been represented as a <code>factor</code>. The same could be said of the
variable <code>am</code> which is also a binary variable indicating
<code>0</code> for an automatic transmission and 1 for a manual.</p>
<p>To make the point, we replace these two numeric variables by
factors.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span><span class="op">$</span><span class="va">vs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">vs</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V-shaped"</span>, <span class="st">"straight"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"automatic"</span>, <span class="st">"manual"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>so that the first few rows of <code>mtcars</code> now look like</p>
<table class="table">
<colgroup>
<col width="21%">
<col width="6%">
<col width="4%">
<col width="6%">
<col width="4%">
<col width="6%">
<col width="7%">
<col width="7%">
<col width="10%">
<col width="12%">
<col width="6%">
<col width="6%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">mpg</th>
<th align="right">cyl</th>
<th align="right">disp</th>
<th align="right">hp</th>
<th align="right">drat</th>
<th align="right">wt</th>
<th align="right">qsec</th>
<th align="left">vs</th>
<th align="left">am</th>
<th align="right">gear</th>
<th align="right">carb</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Mazda RX4</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.620</td>
<td align="right">16.46</td>
<td align="left">V-shaped</td>
<td align="left">manual</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">Mazda RX4 Wag</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.875</td>
<td align="right">17.02</td>
<td align="left">V-shaped</td>
<td align="left">manual</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">Datsun 710</td>
<td align="right">22.8</td>
<td align="right">4</td>
<td align="right">108</td>
<td align="right">93</td>
<td align="right">3.85</td>
<td align="right">2.320</td>
<td align="right">18.61</td>
<td align="left">straight</td>
<td align="left">manual</td>
<td align="right">4</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Hornet 4 Drive</td>
<td align="right">21.4</td>
<td align="right">6</td>
<td align="right">258</td>
<td align="right">110</td>
<td align="right">3.08</td>
<td align="right">3.215</td>
<td align="right">19.44</td>
<td align="left">straight</td>
<td align="left">automatic</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Hornet Sportabout</td>
<td align="right">18.7</td>
<td align="right">8</td>
<td align="right">360</td>
<td align="right">175</td>
<td align="right">3.15</td>
<td align="right">3.440</td>
<td align="right">17.02</td>
<td align="left">V-shaped</td>
<td align="left">automatic</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Valiant</td>
<td align="right">18.1</td>
<td align="right">6</td>
<td align="right">225</td>
<td align="right">105</td>
<td align="right">2.76</td>
<td align="right">3.460</td>
<td align="right">20.22</td>
<td align="left">straight</td>
<td align="left">automatic</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>The eikosogram of these two factors can be compared without
contructing a table; <code><a href="../reference/eikos.html">eikos()</a></code> does the counting of matching
rows to produce the picture.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eikos.html">eikos</a></span><span class="op">(</span><span class="va">am</span> <span class="op">~</span> <span class="va">vs</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span></code></pre></div>
<p><img src="img/DataAnalysis/amvs.png" class="r-plt" alt="" width="50%" style="display: block; margin: auto;"></p>
<p>This matching <strong>does not depend on the variables being
factors</strong>. Any variable in a <code>data.frame</code> would do and
would be treated as if it were categorical. In the <code>mtcars</code>
data, there are several variables that are effectively <em>ordinal
categorical</em> variates, namely <code>cyl</code>, <code>gear</code>,
and <code>carb</code>.</p>
<p>These too could be explored using eikosograms. Transmission type
versus number of cylinders</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eikos.html">eikos</a></span><span class="op">(</span><span class="va">am</span> <span class="op">~</span> <span class="va">cyl</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span></code></pre></div>
<p><img src="img/DataAnalysis/amordinal1.png" class="r-plt" alt="" width="40%" style="display: block; margin: auto;"></p>
<p>and number of forward gears versus number of cylinders</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eikos.html">eikos</a></span><span class="op">(</span><span class="va">gear</span> <span class="op">~</span> <span class="va">cyl</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span></code></pre></div>
<p><img src="img/DataAnalysis/ordinal2.png" class="r-plt" alt="" width="37%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="fitted-models">fitted models<a class="anchor" aria-label="anchor" href="#fitted-models"></a>
</h2>
<p>There are numerous types of models that can be fitted to categorical
data. One of the more popular are generalized linear models. For
example, we might fit a log-linear model to the <code>lizards</code>
habitat data.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fittedModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">count</span> <span class="op">~</span> <span class="va">species</span> <span class="op">+</span> <span class="va">perch_height_ft</span>, </span>
<span>                   family<span class="op">=</span><span class="st">"poisson"</span>, </span>
<span>                   data <span class="op">=</span> <span class="va">lizards</span><span class="op">)</span></span></code></pre></div>
<p>This is a “main effects” only model and contains no interaction term.
To see what this model asserts about the relationship between
<code>species</code> and <code>perch_height</code>, we need to use the
<code>fitted.values</code> from the model as the <strong>expected
counts</strong>. A new <code>data.frame</code> is constructed from the
fit as follows:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Can simply append the fitted values to the lizards to get a new data frame</span></span>
<span><span class="va">lizardsFit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">lizards</span>,  fit <span class="op">=</span> <span class="va">fittedModel</span><span class="op">$</span><span class="va">fitted.values</span><span class="op">)</span></span>
<span><span class="co"># and create the table</span></span>
<span><span class="va">fitTable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="va">fit</span> <span class="op">~</span>  <span class="va">species</span> <span class="op">+</span> <span class="va">perch_height_ft</span>,  data<span class="op">=</span><span class="va">lizardsFit</span><span class="op">)</span></span></code></pre></div>
<p>The eikosogram corresponding to the model fitted to these two
variables is</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eikos.html">eikos</a></span><span class="op">(</span><span class="st">"species"</span>, <span class="st">"perch_height_ft"</span>, data <span class="op">=</span> <span class="va">fitTable</span><span class="op">)</span></span></code></pre></div>
<p><img src="img/DataAnalysis/poisson1.png" class="r-plt" alt="" width="60%" style="display: block; margin: auto;">
from which we can see that the model is asserting that
<code>species</code> and <code>perch_height_ft</code> are independently
distributed. In log-linear modelling, independence and conditional
independence are asserted by the interaction terms which appear in these
(hierarchical) models.</p>
<p>For example, the following model forces independence between
<code>perch_height_ft</code> and <code>perch_diameter_inches</code>,
<em>conditional on</em> <code>species</code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fittedModel3way</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">count</span> <span class="op">~</span> <span class="va">species</span> <span class="op">+</span> <span class="va">perch_height_ft</span> <span class="op">+</span> <span class="va">perch_diameter_inches</span> <span class="op">+</span></span>
<span>                           <span class="va">perch_height_ft</span> <span class="op">*</span> <span class="va">species</span> <span class="op">+</span> </span>
<span>                           <span class="va">perch_diameter_inches</span> <span class="op">*</span> <span class="va">species</span>, </span>
<span>                       family<span class="op">=</span><span class="st">"poisson"</span>, </span>
<span>                       data <span class="op">=</span> <span class="va">lizards</span><span class="op">)</span></span></code></pre></div>
<p>The absence of the terms
<code>perch_height_ft * perch_diameter_inches</code> and
<code>perch_height_ft * perch_diameter_inches * species</code> means
that when <code>species</code> is held fixed, the terms
<code>perch_height_ft</code> and <code>perch_diameter_inches</code> are
sepable in the model. Hence they are conditionally independent. As
before, we can see this by viewing the eikosogram for the fitted
values.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Can simply append the fitted values to the lizards to get a new data frame</span></span>
<span><span class="va">lizardsFit3way</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">lizards</span>,  fit <span class="op">=</span> <span class="va">fittedModel3way</span><span class="op">$</span><span class="va">fitted.values</span><span class="op">)</span></span>
<span><span class="co"># and create the table</span></span>
<span><span class="va">fitTable3way</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="va">fit</span> <span class="op">~</span>  <span class="va">species</span> <span class="op">+</span> <span class="va">perch_height_ft</span> <span class="op">+</span> <span class="va">perch_diameter_inches</span>,  data<span class="op">=</span><span class="va">lizardsFit3way</span><span class="op">)</span></span>
<span><span class="co"># and show the eikosograms</span></span>
<span><span class="fu"><a href="../reference/eikos.html">eikos</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"perch_diameter_inches"</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"perch_height_ft"</span>, <span class="st">"species"</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">fitTable3way</span>,</span>
<span>      xlab_rot <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<p><img src="img/DataAnalysis/poisson2.png" class="r-plt" alt="" width="60%" style="display: block; margin: auto;">
and the conditional independence asserted by the model becomes obvious.
See also <a href="../doc/IndependenceExploration.html">vignette on
independence exploration</a>.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">references<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-fienberg80" class="csl-entry">
Fienberg, Stephen E. 1980. <em><span class="nocase">The Analysis of
Cross-Classified Categorical Data</span></em>. 2nd ed. MIT Press.
</div>
<div id="ref-Schoener_1968" class="csl-entry">
Schoener, Thomas W. 1968. <span>“The Anolis Lizards of Bimini: Resource
Partitioning in a Complex Fauna.”</span> <em>Ecology</em> 49 (4):
704–26. <a href="https://doi.org/10.2307/1935534" class="external-link">https://doi.org/10.2307/1935534</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Wayne Oldford, Erle Holgersen, Ben Lafreniere, Tianlu Zhu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
